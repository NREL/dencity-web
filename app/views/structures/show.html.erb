<h2>Building</h2>
<h3 class="edit-name"><%= @structure.id %> <% if can? :update, @structure %><%= link_to "[ edit ]", edit_structure_path(@structure), class: "edit-link" %><% end %></h3>
<table class="table table-striped">
  <% @structure.attributes.keys.each do |key| %>
    <% unless key == "created_at" or key == "updated_at" %>
      <% if key == 'user_id' and !can? :update, @structure  %>
      <% else %>
        <tr>
          <th> <%= key == "_id" ? "ID" : key.humanize%></th>
          <td><% if key == 'user_id' %><%= @structure.user.email %><% else %><%= @structure[key] %><% end %></td>
        </tr>
      <% end %>
    <% end %>

  <% end %>
</table>

<h3>Provenance</h3>
<table class="table table-striped">
  <tr>
    <th>Name</th>
    <th>Analysis Types</th>
  </tr>
  <% if @structure.provenance %>
  <tr>
    <td><%= link_to @structure.provenance.display_name, provenance_path(@structure.provenance) %></td>
    <td><%= @structure.provenance.analysis_types.join(', ') %></td>
  </tr>
  <% end %>
</table>

<h3>Measures</h3>
<% if @structure.measure_instances %>
  <div class="panel-group" id="accordion">
    <% @structure.measure_instances.sort.each do |measure| %>
    <div class="panel panel-default">
      <div class="panel-heading">
        <h4 class="panel-title">
          <a data-toggle="collapse" data-parent="#accordion" href="#<%= measure.uuid %>">
            <%= measure.measure_description.nil? ? measure.uuid : measure.measure_description.name %>
          </a>
        </h4>
      </div>
      <div id="<%= measure.uuid %>" class="panel-collapse collapse">
        <div class="panel-body">
          <table class="table table-striped">
            <tr>
              <th>Measure Name</th>
              <td><%= link_to measure.measure_description.name, measure.measure_description unless measure.measure_description.nil? %></td>
            </tr>
            <tr>
              <th>Measure Type</th>
              <td><%= measure.measure_description.type unless measure.measure_description.nil? %></td>
            </tr>
            <tr>
              <th>UUID</th>
              <td><%= measure.uuid %></td>
            </tr>
            <tr>
              <th>Version ID</th>
              <td><%= measure.version_id %></td>
            </tr>
            <% unless measure.arguments.nil? %>
              <% measure.arguments.each do |arg| %>
                <tr>
                  <th><%= arg %></th>
                  <td></td>
                </tr>
              <% end %>
            <% end %>
          </table>
        </div>
      </div>
    </div>
    <% end %>
  </div>
<% end %>

<h3>Attachments</h3>
<table class="table table-striped">
  <tr>
    <th>Filename</th>
    <th>Actions</th>
  </tr>
  <% @structure.attachments.each do |file| %>
      <tr>
        <td> file.filename</td>
        <td> file.filename</td>
        <td>BUTTON TO DOWNLOAD</td>
      </tr>
  <% end %>
</table>

